<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>H40N - N.ROOT | CONTINGENCY</title>
<style>
    :root{
        --bg:#0a0a0a;
        --panel:#111;
        --panel-2:#1a1a1a;
        --text:#e5e5e5;
        --muted:#9aa4ac;
        --accent:#4ecbff;
        --prompt:#00e676;
        --user:#6ac8ff;
        --admin:#e5e5e5;
    }
    html,body{
        height:100%;
        margin:0;
        background:var(--bg);
        font-family:monospace;
        color:var(--text);
    }
    .terminal-wrapper{
        width:92%;
        max-width:980px;
        margin:28px auto;
        border-radius:10px;
        overflow:hidden;
        border:1px solid #222;
        box-shadow:0 10px 50px rgba(0,0,0,0.7);
        background:linear-gradient(180deg,var(--panel),#0f0f0f);
    }
    .terminal-header{
        display:flex;
        align-items:center;
        gap:10px;
        padding:12px;
        background:var(--panel-2);
        border-bottom:1px solid #222
    }
    .dot{
        width:12px;
        height:12px;
        border-radius:50%
    }
    .red{background:#ff5f56}
    .yellow{background:#ffbd2e}
    .green{background:#27c93f}
    
    .terminal-title{
        flex:1;
        text-align:center;
        opacity:.85;
        font-size:0.95rem
    }
    #output{
        height:68vh;
        padding:20px;
        overflow-y:auto;
        white-space:pre-wrap;
        line-height:1.35;
        font-size:0.98rem
    }
    .terminal-input-area{
        display:flex;
        align-items:center;
        gap:10px;
        padding:12px;
        background:var(--panel-2);
        border-top:1px solid #222
    }
    #prompt{color:var(--prompt);font-weight:700}
    /* fake input box (disabled) */
    .input-disabled{
        flex:1;
        padding:10px 12px;
        border-radius:6px;
        border:1px dashed #2b2b2b;
        background:transparent;
        color:var(--muted);
        font-family:monospace;
        font-size:0.95rem;
    }
    .note-strong{color:#ff9aa2;font-weight:700}
    .line{margin:6px 0}
    .meta{color:var(--muted)}
    .user-NOAH{color:#3ee9e9}
    .user-ECH0{color:#17acec}
    .admin-msg{color:var(--admin)}
    .process{color:#ffdb25}
    .sucess{color:#00e676}

    /* typing caret for lines being typed */
    .typing-caret::after{
        content: "|";
        display:inline-block;
        margin-left:6px;
        animation: blink 1s steps(2,start) infinite;
        color:var(--text);
    }
    @keyframes blink{50%{opacity:0}}
    /* small emphasis */
    .em{color:var(--accent)}
    /* scrollbar cosmetic */
    #output::-webkit-scrollbar{width:10px}
    #output::-webkit-scrollbar-thumb{background:#111;border-radius:6px}

    .gap {
    height: 22px;     /* tamanho visual do salto */
    display: block;
    }

    .progress-bar-container {
    width: 100%;
    background: #111;
    border: 1px solid #222;
    border-radius: 6px;
    margin-top: 8px;
    padding: 6px;
    }

    .progress-label {
    margin-top: 4px;
    font-size: 0.85rem;
    color: var(--muted);
    }

    /* animação de "processando" na barra fixa */
.progress-bar {
    height: 14px;
    width: 0%;
    background: var(--accent);
    border-radius: 4px;
    transition: width 1.6s ease;
    position: relative;
    overflow: hidden;
}

/* efeito de brilho se movendo dentro da barra */
.progress-bar::after {
    content: "";
    position: absolute;
    top: 0;
    left: -40%;
    width: 40%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255,255,255,0.35),
        transparent
    );
    animation: barShine 1.4s infinite linear;
    mix-blend-mode: screen;
}

@keyframes barShine {
    0% { left: -40%; }
    100% { left: 140%; }
}


</style>
</head>
<body>
<div class="terminal-wrapper" role="region" aria-label="Contingency Terminal">
    <div class="terminal-header">
        <div class="dot red"></div>
        <div class="dot yellow"></div>
        <div class="dot green"></div>
        <div class="terminal-title">H40N - N.ROOT | CONTINGENCY</div>
    </div>

    <div id="output" aria-live="polite"></div>

    <div class="terminal-input-area" aria-hidden="true">
        <div id="prompt">&gt;</div>
        <!-- área onde usuário podia digitar: permissão removida -->
        <div class="input-disabled" title="Escrita desativada">
            &nbsp;Aguarde o sistema restaurar. Não é possível inserir comandos agora.
        </div>
    </div>
</div>

<script>
const output = document.getElementById('output');

let progressBarFixed = null;
let hasShownFirstBar = false;

// ----- FUNÇÃO: cria barra fixa ou atualiza -----
function updateFixedProgress(percent) {
    if (!progressBarFixed) {
        progressBarFixed = document.createElement("div");
        progressBarFixed.className = "progress-bar-container";

        const bar = document.createElement("div");
        bar.className = "progress-bar";
        bar.style.width = percent + "%";

        const label = document.createElement("div");
        label.className = "progress-label";
        label.textContent = `Restaurando sistema... ${percent}%`;

        progressBarFixed.appendChild(bar);
        progressBarFixed.appendChild(label);

        output.appendChild(progressBarFixed);
    } else {
        const bar = progressBarFixed.querySelector(".progress-bar");
        const label = progressBarFixed.querySelector(".progress-label");

        bar.style.width = percent + "%";
        label.textContent = `Restaurando sistema... ${percent}%`;
    }
}

// ----- FUNÇÃO: remove linhas ENTRE o índice 8 até antes da barra -----
// (mantive essa função, não usada se você prefere backspace; deixei por segurança)
function removeInitialLines() {
    const children = Array.from(output.children);

    // Mantém tudo até a barra fixa
    const preserveUntil = children.indexOf(progressBarFixed);

    for (let i = preserveUntil - 1; i >= 2; i--) {
        output.removeChild(children[i]);
    }
}

// ----- FUNÇÃO: apaga bloco com animação de backspace -----
async function eraseBlock(lines) {
    for (let i = lines.length - 1; i >= 0; i--) {
        const el = lines[i];

        // animação de backspace
        await new Promise(resolve => {
            const interval = setInterval(() => {
                if (el.textContent.length > 0) {
                    el.textContent = el.textContent.slice(0, -1);
                } else {
                    clearInterval(interval);
                    resolve();
                }
            }, 25);
        });

        if (el.parentElement) el.parentElement.removeChild(el);
    }
}

// ----- FUNÇÃO: cria uma linha -----
function appendLine(cls = "") {
    const el = document.createElement('div');
    el.className = 'line ' + cls;
    output.appendChild(el);
    output.scrollTop = output.scrollHeight;
    return el;
}

// ----- FUNÇÃO: escreve linha com efeito -----
function typeLine(el, text) {
    return new Promise(resolve => {
        if (typeof text !== "string") text = String(text || "");
        let i = 0;
        function step() {
            el.textContent += text[i] || "";
            i++;

            if (i < text.length) setTimeout(step, 12 + Math.random() * 30);
            else resolve();
        }
        if (text.length === 0) resolve();
        else step();
    });
}

// =======================
//   INÍCIO DA ANIMAÇÃO
// =======================

async function start() {

    // ---------- FIXOS ----------
    const fixed = [
    { text: "[04.12.2025 - 03:33:03]", cls: "meta" },
    { text: "", cls: "" },

    // estes serão apagados assim que a barra aparecer
    { text: "H40N.inject(): system/core/reset - force", cls: "user-NOAH" },
    { text: "Iniciando reinicialização do contingency", cls: "process" },
    { text: "CONTINGENCY.TERMINAL - RECOVERY MODE [03%]", cls: "admin-msg" }
    ];


    let fixedEls = [];

    for (let item of fixed) {
        let text = typeof item === "string" ? item : item.text;
        let cls  = typeof item === "string" ? ""    : item.cls;

        const el = appendLine(cls);
        fixedEls.push(el);

        await typeLine(el, text);
    }


    // BAR FIXA INICIAL
    updateFixedProgress(3);
    hasShownFirstBar = true;

    // delay antes de apagar (você pode ajustar o tempo aqui)
    await new Promise(r => setTimeout(r, 1500));

    // identificar as linhas que serão apagadas (usando animação de backspace)
    const linesToErase = fixedEls.slice(2); 
    // índice 0 = data, 1 = linha vazia → ficam
    // índice 2+ = reset, iniciando, recovery 03% → apagam

    // apagar com animação de backspace
    await eraseBlock(linesToErase);

    // ======================
    //   BLOCOS DINÂMICOS
    // ======================

    const blocks = [
        {
            lines: [
                {text: "[H40N] ok… só mais alguns blocos", cls: "user-NOAH" },
                {text: "ECH0.signing in", cls: "sucess"},
                {text: "[H40N] anda, anda…", cls: "user-NOAH"},
                {text: "[ECH0] impossível acelerar. “correr” não é um parâmetro interno", cls: "user-ECH0"},
                {text: "[H40N] então inventa", cls: "user-NOAH"},
            ],
            after: 3
        },
        {
            lines: [
                {text: "[H40N] eu vou surtar com todo esse silêncio", cls: "user-NOAH"},
                {text: "[ECH0] você é tão dramatico", cls: "user-ECH0"},
                {text: "CONTINGENCY.TERMINAL - RECOVERY MODE [63%]", cls:"admin-msg"},
            ],
            progress: 63,
            after: 3
        },
        {
            lines: [
                {text: "ECH0.inject(): play/rap-hashirama.mp3", cls: "user-ECH0"},
                {text: "reproduzindo: “Rap do Hashirama – 7 Minutoz”", cls: "admin-msg"},
                {text: "classificação interna: “música de batalhar contra o desespero”", cls: "meta"},
                {text: "[H40N] isso foi ofensivo", cls: "user-NOAH"},
                {text: "[ECH0] você quem marcou como favorita algumas vezes", cls: "user-ECH0"},
                {text: "[H40N] você me irrita", cls: "user-NOAH"},
            ],
            after: 3
        },
        {
            lines: [
                {text: "CONTINGENCY.TERMINAL - RECOVERY MODE [83%]", cls: "admin-msg"},
                {text: "ECH0.inject(): system/core/reset/rtemp :: 50%", cls: "user-ECH0"},
                {text: "Processo de reinicialização alterado", cls: "process"},
                {text: "CONTINGENCY.TERMINAL - RECOVERY MODE [33%]", cls: "admin-msg"},
            ],
            progress: 33,
            after: 3
        },
        {
            lines: [
                {text: "[H40N] você mexeu no relógio?", cls: "user-NOAH"},
                {text: "[ECH0] não, não.", cls: "user-ECH0"},
                {text: "[ECH0] por favor, continue ouvindo seu… rap motivacional de ninja", cls: "user-ECH0"},
            ],
            after: 3
        },
        {
            lines: [
                {text: "ECH0.signing out" , cls: "user-ECH0"},
                {text: "[H40N] blablabla eu sou o ECH0 e sou chato", cls: "user-NOAH"},
                {text: "[H40N] virus do diabo", cls: "user-NOAH"},
            ],
            after: 3
        },
                {
            lines: [
                {text: "RECOVERY MODE EM PROGRESSO", cls: "admin-msg"},
            ],
            after: 100
        }
    ];

    // ----- LOOP DOS BLOCOS -----
    for (const block of blocks) {

        // limpar área abaixo da barra antes de escrever o bloco
        while (output.lastChild && output.lastChild !== progressBarFixed) {
            output.removeChild(output.lastChild);
        }

        // escrever bloco
        let created = [];
        for (let item of block.lines) {

            // permite usar string ou {text, cls}
            let text = typeof item === "string" ? item : item.text;
            let cls  = typeof item === "string" ? ""    : item.cls;

            const el = appendLine(cls);
            created.push(el);

            await typeLine(el, text);

            // detecta porcentagem para atualizar barra
            const match = text.match(/\[(\d+)%\]/);
            if (match) updateFixedProgress(Number(match[1]));
        }


        await new Promise(r => setTimeout(r, block.after * 1000));

        // apagar bloco com animação
        await eraseBlock(created);
    }
}

setTimeout(start, 500);
</script>
</body>
</html>
